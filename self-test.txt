; Self test
; Stores and loads values in the registers

; Initialization, stack contains ERROR code
        PUSH #255

; Initialization, registers are populated with Rx = dec(x)
        MOV R0 #0
        MOV R1 #1
        MOV R2 #2
        MOV R3 #3
        MOV R4 #4
        MOV R5 #5
        MOV R6 #6
        MOV R7 #7

; Check, we verify that each register contains
; its appropriate value
        CMP R0 #0
        JNE error
        CMP R1 #1
        JNE error
        CMP R2 #2
        JNE error
        CMP R3 #3
        JNE error
        CMP R4 #4
        JNE error
        CMP R5 #5
        JNE error
        CMP R6 #6
        JNE error
        CMP R7 #7
        JNE error

; Program ends here
        HLT

; In case of read/write mismatch, error code is fetched
; from stack and stored in R0
error:
        POP R0
        HLT